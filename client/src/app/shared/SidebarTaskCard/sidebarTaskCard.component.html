<div class="bg-white rounded-md relative">
    <div *ngIf="!edit; else elseBlock;">
        <div class="absolute top-2 right-2">
            <div class="flex items-center" *ngIf="isOwner">
                <button (click)="deleteTask()" class="text-neutral-400 hover:text-white rounded-md text-xl flex justify-center items-center"><ng-icon name="heroTrash"></ng-icon></button>
                <button (click)="changeEdit()" class="text-neutral-400 hover:text-white rounded-md text-xl ml-1 flex justify-center items-center"><ng-icon name="heroPencilSquare"></ng-icon></button>
            </div>  
        </div>
        <div *ngIf="task.img">
            <div class="overflow-hidden rounded-t-md max-h-36">
                <img class="w-full object-cover rounded-t-md" [src]="task.img" [alt]="task.title" />
            </div>
        </div>
        <div class="p-5">
            <div>
                <h1 class="font-semibold text-lg">{{ task.title }}</h1>
                <p>{{ task.details }}</p>
            </div>
            <div class="mt-5">
                <h1 class="font-semibold text-lg">Schedule</h1>
                <p>Current Date: {{ currentDate }}</p>
                <p>Deadline: {{ deadline  }}</p>
                <p>Timeleft: <span class="text-red-500 font-semibold">{{ diff }}</span></p>
            </div>
            <div class="mt-5" *ngIf="task.links.length > 0">
                <h1 class="font-semibold text-lg">Related</h1>
                <div>
                    <div class="flex items-center" *ngFor="let link of task.links">
                        <p>{{ link.title }}: </p>
                        <a [href]="link.link" target="_blank" class="text-blue-500 underline break-all cursor-pointer">{{ link.link }}</a>
                    </div>
                </div>
            </div>
            <div class="mt-5">
                <div class="flex items-center justify-end">
                    <input checked id="checked-checkbox" type="checkbox" disabled [checked]="task.completed" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label for="checked-checkbox" class="ml-2 text-lg font-medium">Completed</label>
                </div>
            </div>
        </div>
    </div>
    <ng-template #elseBlock>
        <div *ngIf="isOwner">
            <div class="flex">
                <button (click)="changeEdit()" class="flex-1 border-2 border-red-500 text-red-500 hover:bg-red-500 hover:text-white rounded-tl-md text-xs p-1 px-2 flex items-center justify-center transition-all duration-300">Cancel</button> 
                <button (click)="updateTask()" class="flex-1 border-2 border-green-500 text-green-500 hover:bg-green-500 hover:text-white rounded-tr-md text-xs p-1 px-2 flex items-center justify-center transition-all duration-300">Save <ng-icon class="ml-1" name="heroPencilSquare"></ng-icon></button> 
            </div>
            <div class="p-5">
                <div>
                    <input (change)="onChangeInput($event)" [value]="updateTaskInput.title" type="text" name="title" class="rounded-md w-full p-1 border-2 border-black outline-none" />
                    <input (change)="onChangeInput($event)" [value]="updateTaskInput.details" type="text" name="details" class="rounded-md w-full p-1 border-2 border-black outline-none" />
                </div>
                <div>
                    <input (change)="onChangeFile($event)" name="img" type="file" placeholder="img" class="mt-2 p-3 rounded-md w-full text-white" />
                    <div *ngIf="updateTaskInput.img.url">
                        <div class="overflow-hidden rounded-t-md max-h-36">
                            <img class="w-full object-cover rounded-t-md" [src]="updateTaskInput.img.url" [alt]="updateTaskInput.title" />
                        </div>
                    </div> 
                </div>
                <div class="mt-5">
                    <h1 class="font-semibold text-lg">Schedule</h1>
                    <p>Current Date: {{ currentDate }}</p>
                    <p>Deadline: {{ deadline  }}</p>
                    <p>Timeleft: <span class="text-red-500 font-semibold">{{ diff }}</span></p>
                </div>
                <div class="mt-5">
                    <h1 class="font-semibold text-lg">Related</h1>
                    <div>
                        <div class="flex">
                            <input (change)="onChangeLinkInput($event)" [value]="createLinkInput.title" type="text" name="title" class="rounded-md w-full p-1 border-2 border-black outline-none" />
                            <input (change)="onChangeLinkInput($event)" [value]="createLinkInput.link" type="text" name="link" class="rounded-md w-full p-1 border-2 border-black outline-none" />
                        </div>
                        <button (click)="addLink()" class="bg-green-500 text-white rounded-md p-2">Add link+</button>
                    </div>
                    <div *ngIf="updateTaskInput.links.length > 0">
                        <div class="relative" *ngFor="let link of updateTaskInput.links; index as i">
                            <button (click)="removeLink(i)" class="bg-red-500 text-white absolute top-0 right-0 rounded-[50%] w-5 h-5 text-xs">X</button>
                            <div class="flex items-center">
                                <p>{{ link.title }}: </p>
                                <a [href]="link.link" target="_blank" class="text-blue-500 underline break-all cursor-pointer">{{ link.link }}</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-5">
                    <div class="flex items-center justify-end">
                        <input (change)="onChangeCompleted($event)" name="completed" checked id="checked-checkbox" type="checkbox" [checked]="task.completed" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                        <label for="checked-checkbox" class="ml-2 text-lg font-medium">Completed</label>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
</div>